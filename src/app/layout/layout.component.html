<div class="container-fluid pt-4">
  <div class="d-flex flex-column gap-4">
    <div class="row">
      <div class="col-12">
        <div class="d-flex align-items-center justify-content-left w-100">
          <h1 class="fs-1">{{ 'piezas de lego' | titlecase }}</h1>
        </div>
      </div>
    </div>
    <div class="row justify-content-between gap-2">
      <div class="col-lg-4 col-md-2 col-sm-12">
        <div class="d-flex align-items-center gap-2 w-100 filters">
          <p-select
            placeholder="Seleccione una opciÃ³n"
            [options]="selectOptions"
            optionLabel="header"
            style="text-transform: capitalize"
            [(ngModel)]="selectValue"
          />
          <p-auto-complete
            #inputElement
            [(ngModel)]="inputValue"
            [suggestions]="options"
            (completeMethod)="onInput()"
            (onSelect)="getLegos()"
            (onClear)="clearInput()"
            [showClear]="true"
          />
        </div>
      </div>
      <div class="col-lg-6 col-md-7 col-sm-12">
        <div class="d-flex align-items-center justify-content-end gap-2 buttons">
          <p-button
            label="Agregar Nuevo Lego"
            severity="primary"
            icon="pi pi-plus"
            [style]="{ width: '100%', 'min-width': '150px' }"
            (onClick)="openAddModal()"
          ></p-button>
          <p-button
            label="Buscar Lego o Pieza"
            severity="info"
            icon="pi pi-search"
            [style]="{ width: '100%', 'min-width': '150px' }"
            (onClick)="openAddModal()"
          ></p-button>
        </div>
      </div>
    </div>
    @if (legos.length > 0 && inputValue !== '') {
    <div class="table-responsive">
      <p-table
        [value]="legos"
        [columns]="cols"
        [first]="first"
        [tableStyle]="{ 'min-width': '50rem' }"
        paginator="true"
        [rows]="rows"
        [rowsPerPageOptions]="[4, 8]"
        (onPage)="pageChange($event)"
        [loading]="isLoading"
        showGridlines
        stripedRows
      >
        <ng-template #header let-columns>
          <tr></tr>
          <tr>
            <th *ngFor="let col of columns" [style.min-width]="col.minwidth">
              {{ col.header | titlecase }}
            </th>
            <th>Acciones</th>
          </tr>
        </ng-template>
        <ng-template #body let-rowData let-columns="columns">
          <tr>
            <td *ngFor="let col of columns">
              @if (col.field !== 'imagen_pieza' && col.field !== 'imagen_lego') {
              {{ rowData[col.field] }}
              }@else {
              <img [src]="rowData[col.field]" alt="" style="width: 100px; height: 100px" />
              }
            </td>
            <td>
              <div class="d-flex flex-column gap-2">
                <div>
                  <p-button
                    label="Editar Lego"
                    severity="primary"
                    [style]="{ width: '100%', 'min-width': '150px' }"
                    (onClick)="onEdit(rowData)"
                  ></p-button>
                </div>
                <p-button
                  label="Eliminar Lego"
                  severity="danger"
                  [style]="{ width: '100%', 'min-width': '150px' }"
                  (onClick)="onDelete(rowData['id'])"
                ></p-button>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    }

    <p-toast />
    <p-confirm-dialog />
  </div>
</div>
